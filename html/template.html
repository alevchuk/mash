<!DOCTYPE html>

<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

  <!-- <script src="http://code.jquery.com/jquery-latest.min.js"></script> -->
  <script src="http://code.jquery.com/jquery-latest.js"></script>
  <style type="text/css">
    b  { font-weight: normal; position: relative}
    b  { padding: 2px; padding-left: 4px; padding-right: 4px }
    .s { white-space: pre; font-family: "Nimbus Mono L", monospace;}

   .ruler-mark {
     position: absolute;
     top: 0;
     right: 4px;
   }

   .method {
      margin: 4px;
      margin-left: 1em;  
      display: block;
    }

    #method-selector {
      position: fixed; right: 20px; top: 20px;
      letter-spacing: 0px; white-space: normal;
      background-color: white; padding: 0.5em;
      border: 1px solid #999999;
      display: none;
    }
    
    .method-selector {
      background-color: white;
      right: 20px; left: auto;
    }

    %%CSS%%

  </style>
  <title>%%TITLE%%</title>
</head>
<body>

<h2 style="float: left">Sequence Alignment Scoring Hypertext Analyzer</h2>
<div style="float: left"><a href="http://github.com/alevchuk/sasha/">(R Source Code)</a></div>
<div style="clear: left"></div>
<h3>%%TITLE%%</h3>

<div id="msa-window">
%%MSA%%
</div>

<div id="method-selector" 
     style="top: auto; border-color: green; bottom: 20px"
><h3 style="margin-top: 0">Main Menu</h3><div
>Scoring Methods:</div>
</div>

<p style="margin-top: 2em;"></p>

<p>
  Generated on %%GEN_DATE%% <br />
  <a href="http://validator.w3.org/check?uri=referer&amp;ss=checked&amp;outline=checked"
    >Valid HTML5</a><br />
  <a href="http://jigsaw.w3.org/css-validator/check/referer"
    >Valid CSS</a>
</p>



<script>
function apply_method(webdata_dir, method_name) {
  $.get(webdata_dir + "/" + method_name + ".html", function(data) {
    $('#msa-window').html(data); 
  });

  // ## ## Too slow!
  // ## $.getJSON(method_name, function(data) {
  // ## 
  // ##   $.each(data.colors, function(k1, c) {
  // ##     $.each(c.positions, function(k2, p) {
  // ##       var residue = $('#seq' + p[0]).children().slice(p[1] - 1, p[2]);
  // ##       residue.css('color', c.color[0]);
  // ##       residue.css('background-color', c.color[1]);
  // ##     });
  // ##   });
  // ## });
}

$.getJSON('%%JSON_MENU_FILE%%', function(data) {
  $.each(data.plugins, function(k1, c) {
    $('<button id="b' + k1 + '" class="method">' +
      c.replace("\.coloring-scorer.html", "") + '</button><div>'
     ).appendTo('#method-selector');

    $('#b' + k1).click(function () {
      apply_method(data.webdata_dir, c);
    });

  });
  $('#method-selector').show();
});
</script>

</body>
</html>
